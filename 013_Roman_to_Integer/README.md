Пока очень медленно. Видимо не стоило копировать по два символа и искать их в хеш-таблице. Создание новой строки и т.д.
В итоге самый медленный))
Пока так, потом исправим.