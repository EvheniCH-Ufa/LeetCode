А тут сортировка слиянием дала лучший результат против хеш-таблицы (1 мсек против 3 мсек)